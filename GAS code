var ss = SpreadsheetApp.getActiveSpreadsheet();
  // ss is now the spreadsheet the script is associated with
var sheet = ss.getSheets()[0]; // sheets are counted starting from 0
  // sheet is the first worksheet in the spreadsheet
var stitchCount = sheet.getRange("D2:D3");
var changeStitch = stitchCount.getValue();
var rowCount = sheet.getRange("B2:B3");
var changeRow = rowCount.getValue();
var stitchPerRow = sheet.getRange("D5");
var valueSPR = stitchPerRow.getValue();
var rowComplete = sheet.getRange("D6");
var stitchZero = changeStitch - valueSPR;
  
  function doTest() {
  SpreadsheetApp.getActiveSheet().getRange('D5').setValue('Test');
}

function storeValue() {
  sheet.getRange("F1").setValue(stitchZero);
}

function leftovers() { 
  if ((changeStitch +1) > valueSPR) {
  stitchCount.setValue(changeStitch - valueSPR);
  add1Row();
  }
}

function zeroStitch() { //this works
    stitchCount.setValue("0")
}

function add1Stitch() {
  checkForSPR();
  if ((changeStitch + 1) === valueSPR) {
    zeroStitch();
    add1Row();
  } else if (changeStitch > valueSPR){
      stitchCount.setValue(changeStitch - valueSPR);
      add1Row();
  } else {
  stitchCount.setValue(changeStitch+1);
  }
}

function add2Stitches() {
  checkForSPR();
  if ((changeStitch +2) > valueSPR) {
  stitchCount.setValue((changeStitch +2) - valueSPR);
  add1Row();
  } else if ((changeStitch + 2) === valueSPR) {
    zeroStitch();
    add1Row();
  } else {
  stitchCount.setValue(changeStitch+2);
  }
}

function add10Stitches() {
    checkForSPR();
    if ((changeStitch +10) > valueSPR) {
        stitchCount.setValue((changeStitch +10) - valueSPR);
    add1Row();
  } else if ((changeStitch + 10) === valueSPR) {
    zeroStitch();
    add1Row();
  } else {
  stitchCount.setValue(changeStitch+10);
  }
}

function add1Row() {
  rowCount.setValue(changeRow+1);
}

function sub1Stitch() {
  stitchCount.setValue(changeStitch-1)
}

function sub1Row() {
  rowCount.setValue(changeRow-1)
}
function onOpen() {
  SpreadsheetApp.getUi() 
      .createMenu('Custom Menu')
      .addItem('Show prompt', 'showPrompt')
      .addToUi();
}

function inputStitchPerRow() {
  var ui = SpreadsheetApp.getUi(); 

  var result = ui.prompt(
      'Stitches per Row',
      'Please enter the number of stitches needed to complete a row',
      ui.ButtonSet.OK_CANCEL);

  // Process the user's response.
  var button = result.getSelectedButton();
  var text = result.getResponseText();
  if (button == ui.Button.OK) {
    // User clicked "OK".
    stitchPerRow.setValue(text);
  } else if (button == ui.Button.CANCEL) {
    // User clicked "Cancel".
    ui.alert('You didn\'t set your stitches per row, please set manually');
  } else if (button == ui.Button.CLOSE) {
    // User clicked X in the title bar.
    ui.alert('Please set stitches per row manually');
  }
}

function checkForSPR () {
  if (valueSPR == "") {
    inputStitchPerRow();
  }
}
